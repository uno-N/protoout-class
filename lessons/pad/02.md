# フォルダーの作成を自動化
Power Automate Desktopの扱いに慣れるため、簡単な自動化をしてみましょう。

## 成果物：『作成日+お好みのテキスト』の名前を持ったフォルダーを自動生成してくれるフロー

以下の手順で成果物を作成します。

1. フローを作成
2. 現在の日付を取得するアクションをフローに追加
3. 取得した日付のデータをテキストに変換するアクションをフローに追加
4. フォルダーを作成するアクションをフローに追加

![image](https://i.gyazo.com/ad1624b06ac9450fd8520416e4412b4d.png)

ここからは一緒に手を動かすタイムです。  

### 1. フローを作成
PADを立ち上げ、「+新しいフロー」をおしてください。

[![Image from Gyazo](https://i.gyazo.com/ed6ea094d047fb60f46f335065dad21d.png)](https://gyazo.com/ed6ea094d047fb60f46f335065dad21d)

以下のウィンドウが立ち上がればOKです。  
フロー名は自分がわかればよいので自由に入れてください。

[![Image from Gyazo](https://i.gyazo.com/d3b4da074752ca9ea45acc7e098f1581.png)](https://gyazo.com/d3b4da074752ca9ea45acc7e098f1581)

フロー名を入力すると以下のウィンドウが立ち上がります。

[![Image from Gyazo](https://i.gyazo.com/f8a93d0329f463eb43eccdacb9297145.png)](https://gyazo.com/f8a93d0329f463eb43eccdacb9297145)

### 2. 現在の日付を取得するアクションをフローに追加

画面左側のアクション一覧から『日時』→『現在の日時を取得します』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。


詳細設定画面が開くので、以下の設定にしてください。
[![Image from Gyazo](https://i.gyazo.com/e60ef0bfa3d9478f06fcb3284ca2d713.png)](https://gyazo.com/e60ef0bfa3d9478f06fcb3284ca2d713)

### 3. 取得した日付のデータをテキストに変換するアクションをフローに追加

取得した現在の日付の情報は、画面右側の変数一覧にある『`CurrentDateTime`』に入っています。まだテキストとして利用できるデータになっていないので、テキストとして使えるようにデータを変換する必要があります。

画面左側のアクション一覧から『テキスト』→『`datetime`をテキストに変換』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。


詳細設定画面が開くので、以下の設定にしてください。  
Power Automateでは変数を **パーセント記号(%)** で囲む必要があります。注意してください。
[![Image from Gyazo](https://i.gyazo.com/f42f5aa488c6fd291304642afc19501c.png)](https://gyazo.com/f42f5aa488c6fd291304642afc19501c)


### 4. フォルダーを作成するアクションをフローに追加

最後のステップです。

画面左側のアクション一覧から『フォルダー』→『フォルダーの作成』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。

詳細設定画面が開くので、以下の設定にしてください。
[![Image from Gyazo](https://i.gyazo.com/c591d1ae76cedef2951e884d1504a6a5.png)](https://gyazo.com/c591d1ae76cedef2951e884d1504a6a5)

"新しいフォルダーを次の場所に作成"の箇所は、フォルダーを作成する先を自分の**PC内の分かる場所**に設定してください。決められなければデスクトップを選びましょう。  
"新しいフォルダー名"には、3で作った日付のテキストデータ（変数）を %で囲い、その外側に、フォルダー名を自由に記入してください。

### 実行してみましょう！

現在、皆さんのフローは以下のような順でアクションが並んでいるはずです。
[![Image from Gyazo](https://i.gyazo.com/88072bdb06ef88686dd3ff19ae79eefb.png)](https://gyazo.com/88072bdb06ef88686dd3ff19ae79eefb)

画面左上にある実行ボタンを押して、フローが正しく走るか試してみましょう。  
フォルダーが新規に作成されていれば成功です。



---

このページの内容は以上です。  
**[目次](./readme.md)** に戻り、全体構成を確認してから講師の指示にしたがって進めましょう。
