# 複数のファイルをまとめて操作
Power Automate Desktopの扱いに慣れるため、引き続き簡単な自動化をしてみましょう。

## 成果物：複数あるファイルのファイル名に連番を一括で付けてくれるフロー

以下の手順で成果物を作成します。

1. フローを作成
2. フォルダー内のファイルを取得するアクションをフローに追加
3. 指定したアクションを繰り返し実行するアクションをフローに追加
4. ファイル名を変更するアクションをフローに追加

### ※フロー制作を進める前に準備

フローを制作する前に、今回のフローで連番を振るファイルを用意しましょう。  
先ほど『2.フォルダーの作成を自動化しよう』で作成したフォルダーの中に、適当なtxtファイルを3つ作成しましょう。分からない人は、自分のPC内で新たにフォルダーを作成しても構いません。

.txtファイルの名前は以下にしてください。
- A.txt
- B.txt
- C.txt

[![Image from Gyazo](https://i.gyazo.com/87842cbe071cc8778d8ffdb8b925cce5.png)](https://gyazo.com/87842cbe071cc8778d8ffdb8b925cce5)

[こちら](https://drive.google.com/file/d/1h22ruvOfbjcK-zWJ01k_hTXRKZSqp3W6/view?usp=sharing) からサンプルファイルをダウンロードすることもできます。

### 1. フローを作成
PADを立ち上げ、「+新しいフロー」を押下してください。

[![Image from Gyazo](https://i.gyazo.com/ed6ea094d047fb60f46f335065dad21d.png)](https://gyazo.com/ed6ea094d047fb60f46f335065dad21d)

以下のウィンドウが立ち上がればOKです。(フロー名は適宜つけてください。)

[![Image from Gyazo](https://i.gyazo.com/f8a93d0329f463eb43eccdacb9297145.png)](https://gyazo.com/f8a93d0329f463eb43eccdacb9297145)

### 2. フォルダー内のファイルを取得するアクションをフローに追加

画面左側のアクション一覧から『フォルダー』→『フォルダー内のファイルを取得』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。


詳細設定画面が開くので、以下の設定にしてください。（フォルダーの場所は各自異なります。自分のPC内から選んでください。）
[![Image from Gyazo](https://i.gyazo.com/bf547b1f256d3dc070ac4c96e8a77d06.png)](https://gyazo.com/bf547b1f256d3dc070ac4c96e8a77d06)

### 3. 指定したアクションを繰り返し実行するアクションをフローに追加
複数のファイル名に変更するため、ファイル名を変更する処理を複数回走るようにします。
画面左側のアクション一覧から『ループ』→『For each』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。


詳細設定画面が開くので、以下の設定にしてください。
[![Image from Gyazo](https://i.gyazo.com/d291b8f9d421c105703bb4bcdb6120a4.png)](https://gyazo.com/d291b8f9d421c105703bb4bcdb6120a4)

### 4. ファイル名を変更するアクションをフローに追加

最後のステップです。

画面左側のアクション一覧から『ファイル』→『ファイルの名前を変更する』を選び、画面中央のフローエリアにドラッグアンドドロップしてください。
この時、3. で用意したアクション`For each`と`End`の間にアクションを配置してください。

詳細設定画面が開くので、以下の設定にしてください。
[![Image from Gyazo](https://i.gyazo.com/19daa45c3d5ace4ba673faee8d093e56.png)](https://gyazo.com/19daa45c3d5ace4ba673faee8d093e56)

### 実行してみましょう！

現在、皆さんのフローは以下のような順でアクションが並んでいるはずです。
[![Image from Gyazo](https://i.gyazo.com/898901e048964d714ba6a466d926fe43.png)](https://gyazo.com/898901e048964d714ba6a466d926fe43)

画面左上にある実行ボタンを押して、フローが正しく走るか試してみましょう。



---

このページの内容は以上です。  
**[目次](./readme.md)** に戻り、全体構成を確認してから講師の指示にしたがって進めましょう。
